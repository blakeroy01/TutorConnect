<!DOCTYPE html>
<html lang="en" dir="ltr">
	<head>
		<meta charset="utf-8">
		<title>TutorConnect : Profile</title>

		<%-# Bootstrap! -%>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
		<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
		<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>


	</head>
	<body>
        <div class = "container-fullwidth">
            <%= render 'dashboard/components/dash_header.html.erb' %>
        </div>
        <form class="form-inline justify-content-center" action="/search">
			<input class="form-control mr-sm-2" name="q" type="text" placeholder="Search subject (ie: math)" aria-label="Seach">
				<button class="btn btn-outline-success" type="submit">Search</button>
		</form>
        <h1>Search Results</h1>
			<table id="searchResults" class="table table-striped table-bordered table-sm" cellspacing="0" width="100%">
				<thead>
				  	<tr>
						<th class="th-sm text-center">Username</th>
					  	<th class="th-sm text-center">Subject</th>
					  	<th class="th-sm text-center">Rating</th>
				  	</tr>
				</thead>
				<tbody>
					<%= @users.each do |user| %>
						<%= user.subject.each do |s| %>
							<% if s == params[:q] %>
								<tr>
									<td class="th-sm text-center"><%= link_to user.username, user_path(user) %></td>
									<td class="th-sm text-center"><%= s %></td>
											<% if user.rating_count != 0 %>
												<td><%= user.rating / user.rating_count %></td>
											<% else %>
												<td> 0 </td>
											<%end%>
								</tr>
							<% end %>
						<%end%>
					<%end%>
				</tbody>
			</table>
			<script>
				$(document).ready(function () {
					$('#searchResults').DataTable({
						"order": [[2, "asc"]]
					});
				});
			</script
    </body>
</html>
